local healthBarEnabled = false

L_19_:NewToggle(
    "HealthBar",
    "Health Bar.",
    function(state)
        healthBarEnabled = state
        if healthBarEnabled then
            game:GetService("RunService").RenderStepped:Connect(function()
                for _, player in pairs(game.Players:GetPlayers()) do
                    if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("Humanoid") then
                        local humanoid = player.Character.Humanoid
                        local health = humanoid.Health
                        local maxHealth = humanoid.MaxHealth
                        local healthPercent = health / maxHealth

                        local color = Color3.fromRGB(255 * (1 - healthPercent), 255 * healthPercent, 0)

                        for _, part in pairs(player.Character:GetChildren()) do
                            if part:IsA("BasePart") then
                                local adornment = Instance.new("BoxHandleAdornment")
                                adornment.Adornee = part
                                adornment.AlwaysOnTop = true
                                adornment.ZIndex = 10
                                adornment.Size = part.Size + Vector3.new(0.1, 0.1, 0.1)
                                adornment.Transparency = 0.5
                                adornment.Color3 = color
                                adornment.Parent = game.CoreGui

                                local selectionBox = Instance.new("SelectionBox")
                                selectionBox.Adornee = part
                                selectionBox.LineThickness = 0.05
                                selectionBox.SurfaceTransparency = 0.5
                                selectionBox.Color3 = color
                                selectionBox.Parent = game.CoreGui
                            end
                        end
                    end
                end
            end)
        else
            for _, v in pairs(game.CoreGui:GetChildren()) do
                if v:IsA("BoxHandleAdornment") or v:IsA("SelectionBox") then
                    v:Destroy()
                end
            end
        end
    end
)
